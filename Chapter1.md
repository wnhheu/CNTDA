# 第一章 计算机网络和因特网

<!--more-->

这一章总体来说内容是直观、简单易懂的，是一个开头的铺垫吧，也没有太多很深奥的内容

## 因特网

主机/端系统： 所有连入因特网的设备

**端系统**通过**通信链路**和**分组交换机**连接到一起

分组：

- 因为数据链路单次传输能力的上限，发送端将数据分段，并为每一段加上首部字节
- 首部字节是记录传输协议、这个包大致信息的内容

分组交换机：从它的一条入链路接收分组，并且选择一条出链路将分组转发出去

端系统通过**因特网服务提供商**接入因特网（这里的提供商有像电信、连通、校园网等等）

分布式应用程序：涉及多个相互交换数据的端系统

协议：就是一套通话的规则

## 网络边缘

接入网：将端系统连入到边缘路由器的物理链路

边缘路由器：端系统到任何其他远程端系统路径上的第一台路由器

---

几种不同的接入方式：

- DSL(Digital Subscribe Line)数字用户线（通过电话线接入）
- CIC(Cable Internet Access)电缆因特网接入（ISP为有线电视公司，通信链路物理材质有光纤、同轴电缆--混合光纤同轴）
- FTTH(Fiber TO The Home)光纤到户（每个用户一根光纤（Active Optical Network）||一根光纤在靠近用户端分成每户一根（Passive Optical Network)
- 以太网和WIFI(以太网：用户使用双绞线与以太网交换机相连，WIFI：无线用户从一个接入点发送和接收数据，而该接入点与企业网相连）
- 广域无线接入（蜂窝）

---

物理媒体

- 导引型媒体：电波沿着固体媒体传播
- 非导引型媒体：电波在空气或外层空间传播

几种物理媒体：

- 双绞线
- 同轴电缆
- 光纤
- 陆地无线电信道
- 卫星无线电信道

## 网络核心

网络核心：由互联端系统的分组交换机和链路构成的网状网络

---

通过网络链路和交换机移动数据：电路交换&分组交换

- 分组交换：相当于直接去餐馆吃饭，但是不一定有位置；在计算机网络中，分组交换在端系统进行通信时不会预留资源，可能会需要等待（排队）

  > 存储转发传输：交换机在收到一个完成的分组，才会向链路输出转发分组，否则就将收到的部分分组缓存起来；因为缓存等待一个分组的全部数据而导致的时间开销被称为存储转发时延
  >
  > 排队时延：在输出缓冲队列等待产生的时延
  >
  > 分组丢失：因为缓冲队列满了而丢弃到达分机的数据包
  >
  > 转发表：分组交换机通过转发表维护IP链路的对应关系，所以能够知道包往哪去（IP地址不在转发表的包会被发往一个默认IP地址）

  特点：比电路交换实现简单，带宽利用率更高，但是不适合实时服务

- 电路交换：相当于预定餐馆的位置；在计算机网络中，电路交换在端系统进行通信时预留一部分资源

  > 时分复用：将时间划分为固定区间的**帧**，每个帧则又被划分为固定数量的时间**空隙**
  >
  > 频分复用：将频率域划分为频段，然后将频段分配给连接；此频段被用来专门传输链接的数据。该频段的宽度成为带宽

  特点：保证端对端传输数据的速率，但是建立连接的过程复杂且资源没有得到充分利用

---

网络的网络：ISP之间的连接也颇为复杂，ISP之间也进行互联

---

## 分组交换中的时延、丢包、吞吐量

时延的类型

- 处理时延：节点需要解析分组的必要信息然后决定其出链路（索引转发表等操作）而产生的时延，通常在微秒或者更低数量级
- 排队时延：分组在链路上等待传输而产生的时延，和队列的流量强度、性质强相关，通常在毫秒级到微秒级
- 传输时延：将所有分组的比特推向链路所有需要的时间，通常在毫秒到微秒数量级
- 传播时延：比特进入链路后，从该链路的起点到下一个结点所用的时间；一旦分组中的最后一个比特到达路由器就意味着该分组的所有比特都已到达路由器

---

流量强度：分组到达的速度/结点的处理速度

流量工程里一个金科玉律就是：设计系统时流量强度不能大于1（大于1的话缓冲队列长度会无限增大

---

吞吐量：描述了比特经过某个节点的速度

某个节点的吞吐量=min｛接收数据的速度，发送数据的速度｝

吞吐量可以近似为源和目的地之间路径的最小传输速率，最小传输速率的链路为**瓶颈链路**。

在今天，因特网对吞吐率的限制因素通常是接入网。

---

### 协议层次及其服务模型

协议栈：各层的所有协议组合起来

---

OSI标准：

- 应用层

  - 针对特定应用的协议

  - 包括文件传输、电子邮件、远程登录等协议

- 表示层

  - 设备固有数据格式和网络标准数据格式的转换

- 会话层

  - 通信管理，负责建立和断开通信连接

  - 管理传输层以下的分层

- 传输层

  - 管理两个节点之间的数据传输

  - 负责可靠传输

- 网络层

  - 地址管理与路由选择

- 数据链路层

  - 互联设备之间传送和识别数据帧

- 物理层

  - 以”0“，”1“代表电压的高低、灯光的闪灭

  - 界定连接器和网线的规格

---

TCP/IP：

- 硬件（物理层）

  - 没有一个既定的指标，TCP/IP是在网络互联的设备之间能够通信的前提之下才被提出的协议

- 网络接口层（数据链路层）

  - 网络接口层利用以太网中的数据链路层进行通信

  - 可以把它当作让NIC起作用的驱动程序

  - 驱动程序是在操作系统与硬件之间起桥梁作用的软件

- 互联网层（网络层）

  - 互联网层使用IP协议，基于IP地址转发分包数据

  - TCP/IP分层中的互联网层与传输层的功能通常由操作系统提供

  - 连接互联网的所有主机和路由器都必须实现IP的功能

  - IP

    - 用IP地址作为主机的标识

    - 隐含着数据链路层的功能，通过IP，相互通信的主机之间不论经过怎样的底层数据链路都能够实现通信

  - ICMP
    - 当数据包发生异常的时候给发送端发送一个发生异常的同志

  - ARP
    - 从分组数据包的IP地址中解析出MAC地址的一种协议

- 传输层

  - TCP

    - 保证两端通信主机之间的通信可达，但是为了建立与断开连接，至少7次发包收包——网络流量的浪费

    - 规范较为复杂（不适合视频会议） 

  - UDP

    - 面向无连接的传输层协议

    - 如果需要检查对端是否接受到分组数据包——在应用程序中实现

    - 用于分组数据较少或多播、广播、视频通信

- 应用层（会话层以上的分层）

  - TCP/IP应用的架构绝大多数属于客户端/服务端模型

  - WWW

    - Web浏览器（一个客户端）

    - 浏览器与服务端通信所用的协议是HTTP（HyperText Transfer Protocol），主要的数据格式是HTML(HyperText Markup Language)

    - HTTP——OSI应用层协议，HTML——OSI表示层协议

  - E-Mail

    - 在网络上发送信件

    - 所使用的协议——SMTP（Simple Mail Transfer Protocol）

  - 文件传输

    - 使用的协议——FTP（File Transfer Protocol）

    - FTP在进行文件传输时会建立两个TCP连接
      - 发出传输请求时所用到的控制连接与实际传输数据时所要用到的数据连接

  - 远程登录

    - TELNET(TELetypewriter NETwork)

    - SSH(Secure SHell)

  - 网络管理

    - SNMP(Simple Network Management Protocol)

    - MIB(Management Information Base)

---

封装：一个包在经过一个层之后会在这个包的头部附加上首部字段，该字段至少会包含两个信息——发送端和接收端地址&上一层的协议类型

## 面对攻击的网络

- 通过网络将恶意软件植入你的计算机中
- Dos/DDoS
  - Dos(Denial-of-Service)：带宽攻击；协议攻击；逻辑攻击
    - 带宽攻击：恶意黑客使用数据流量填满网络。网络由于不能处理发送给他的大量流量而导致系统崩溃和响应速度减慢，从而阻止合法用户的访问。攻击者在网络上传输任何流量都要消耗带宽。基本的洪流攻击能够使用UDP或ICMP数据包消耗掉所有可用带宽。
    - 协议攻击：恶意黑客以目标系统从来没有想到的方式发送数据流，如攻击者发送大量的SYN数据包
    - 逻辑攻击：逻辑攻击的一个典型示例是LAND攻击，这里攻击者发送具有相同源IP地址和目的IP地址的伪数据包。很多系统不能够处理这种引起混乱的行为，从而导致崩溃。
  - 但是Dos有一个问题：大量数据从单一源发出，可能会被某路由器检测出该攻击，并在流量靠近路由器之前就将其阻挡下来，所以有了分布式Dos(Distributed DoS, DDos)

- 伪装成你新来的人
  - IP哄骗：将虚假源地址的分组注入因特网